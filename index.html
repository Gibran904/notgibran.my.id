<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="favicon-32x32.png">
  <title>Game Tebak Angka 1-10000</title>
  <meta name="google-site-verification" content="jxay_hMuTl6xzKRy3NVsp1ZWd_0hVi-vQbaOEoFCW-8" />
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-57DQX32B');</script>
  <!-- End Google Tag Manager -->

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RD92SPVB7K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RD92SPVB7K');
  </script>
  <!-- End Google Analytics -->

  <style>
    /* ... [SEMUA CSS kamu sebelumnya tetap sama, gak diubah] ... */
    /* Gak aku ulangin di sini biar gak panjang. Tapi tetap sama ya */
  </style>
</head>
<body>
  <!-- GTM noscript -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57DQX32B"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End GTM noscript -->

  <h1>Game Tebak Angka</h1>
  <p>Tebak angka dari <strong>1 sampai 10000</strong>!</p>
  <p><input id="guessInput" max="10000" min="1" type="number" /><button onclick="checkGuess()">Tebak</button></p>
  <p id="result"></p>
  <p id="attempts"></p>

  <div id="formSection" style="display:none;">
    <p>Masukkan Nama:</p>
    <input id="playerName" type="text" /><button onclick="submitScore()">Kirim ke Leaderboard</button>
  </div>

  <h2>üèÜ Top 10 Leaderboard</h2>
  <table id="leaderboard">
    <thead>
      <tr><th>Rank</th><th>Nama</th><th>Percobaan</th><th>Waktu</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <p><button id="restartBtn" onclick="restartGame()">Main Lagi</button></p>

  <label class="switch">
    <input type="checkbox" id="theme-toggle">
    <span class="slider"></span>
  </label>

  <p class="footer">Powered by <strong>Vercel</strong>, <strong>GitHub</strong>, <strong>Cloudflare</strong> and <strong>Google</strong></p>

  <a href="https://api.whatsapp.com/send?text=Bisakah%20Anda%20mengalahkanku?%20Kalau%20ya,%20coba%20ini:%20https://notgibran.my.id" target="_blank">
    <button style="background-color: #25D366; color: white; padding: 12px 24px; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">
      Share ke WhatsApp üí¨
    </button>
  </a>

  <script>
    let answer = Math.floor(Math.random() * 10000) + 1;
    let tries = 0;
    let win = false;

    function checkGuess() {
      const guess = parseInt(document.getElementById("guessInput").value);
      tries++;
      let resultText = "";
      let color = "";

      if (guess === answer) {
        resultText = üéâ Selamat! Jawabannya ${answer}. Kamu benar!;
        color = "green";
        document.getElementById("formSection").style.display = 'block';
        document.getElementById("restartBtn").style.display = 'inline-block';
        win = true;
      } else {
        const selisih = Math.abs(guess - answer);
        if (selisih <= 10) {
          resultText = "üò¨ Salah, dikit lagi!";
          color = "orange";
        } else if (guess > answer) {
          resultText = "üìà Salah, kelebihan!";
          color = "red";
        } else {
          resultText = "üìâ Salah, kekurangan!";
          color = "red";
        }
      }

      document.getElementById("result").textContent = resultText;
      document.getElementById("result").style.color = color;
      document.getElementById("attempts").textContent = Percobaan: ${tries};
    }

    function submitScore() {
      if (!win) return;
      const name = document.getElementById("playerName").value;
      if (!name) return alert("Isi nama dulu!");
      const formData = new FormData();
      formData.append("nama", name);
      formData.append("percobaan", tries);

      fetch("https://script.google.com/macros/s/AKfycbxRkBI6EUY0Lf-g9Kxs1MbjOeTk3F4uw-D-FEwTh2bq7IX8lG7zXUyheNcI-oe4kv5W0w/exec", {
        method: "POST",
        body: formData
      })
      .then(res => res.text())
      .then(() => {
        alert("Berhasil dikirim!");
        fetchLeaderboard();
      });
    }

    function fetchLeaderboard() {
      fetch("https://script.google.com/macros/s/AKfycbxRkBI6EUY0Lf-g9Kxs1MbjOeTk3F4uw-D-FEwTh2bq7IX8lG7zXUyheNcI-oe4kv5W0w/exec")
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#leaderboard tbody");
          tbody.innerHTML = "";
          const rows = data.slice(1).sort((a, b) => a[1] - b[1]).slice(0, 10);
          rows.forEach((row, index) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>#${index + 1}</td>
              <td>${row[0]}</td>
              <td>${row[1]}</td>
              <td>${new Date(row[2]).toLocaleString()}</td>
            `;
            tbody.appendChild(tr);
          });
        });
    }

    function restartGame() {
      answer = Math.floor(Math.random() * 10000) + 1;
      tries = 0;
      win = false;
      document.getElementById("guessInput").value = "";
      document.getElementById("result").textContent = "";
      document.getElementById("attempts").textContent = "";
      document.getElementById("formSection").style.display = 'none';
      document.getElementById("restartBtn").style.display = 'none';
    }

    fetchLeaderboard();

    // üî• Dark mode toggle fix
    const toggle = document.getElementById('theme-toggle');
    const body = document.body;

    if (localStorage.getItem('theme') === 'dark') {
      body.classList.add('dark-mode');
      toggle.checked = true;
    }

    toggle.addEventListener('change', () => {
      if (toggle.checked) {
        body.classList.add('dark-mode');
        localStorage.setItem('theme', 'dark');
      } else {
        body.classList.remove('dark-mode');
        localStorage.setItem('theme', 'light');
      }
    });
    fetch("https://ipapi.co/json/")
  .then(res => res.json())
  .then(data => {
    const payload = {
      ip: data.ip,
      country: data.country_name,
      city: data.city,
      org: data.org,
      datetime: new Date().toLocaleString()
    };

    fetch("https://script.google.com/macros/s/AKfycbxRkBI6EUY0Lf-g9Kxs1MbjOeTk3F4uw-D-FEwTh2bq7IX8lG7zXUyheNcI-oe4kv5W0w/exec", {
      method: "POST",
      body: JSON.stringify(payload),
      headers: { "Content-Type": "application/json" }
    });
¬†¬†});
  </script>
</body>
</html>
